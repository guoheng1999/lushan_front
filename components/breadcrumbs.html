<div id="breadcrumbs" class="container">
	<div class="d-flex justify-content-between align-items-center">
		<h2></h2>
		<ol>
			<li><a href="index.html">首页</a></li>
			<li v-for="(item, index) in breadcrumbs" :key="item" @click="toPage(item)"><a href="#">{{item}}</a></li>
		</ol>
	</div>
</div>
<!-- import api.js -->
<script src="assets/js/axios.js"></script>
<script src="assets/js/axios.min.js"></script>
<script src="assets/js/api.js"></script>
<script>
	new Vue({
		el: '#breadcrumbs',
		data() {
			return {
				dataTypeDict: {
					'0': '0级数据',
					'1': '1级数据'
				},
				pageDict: {
					'inner-page-historyData': '历史观测数据',
					'inner-page-currentData': '现代观测数据'
				},
				breadcrumbs: [],
				deviceList: []
			}
		},
		mounted() {
		},
		created() {
			this.initDeviceList()
			this.initCurrentPageName()			
		},
		methods: {
			initCurrentPageName() {
				href_str = window.location.href.split('/').pop().split('.')[0].trim()
				this.breadcrumbs.push(this.pageDict[href_str])
			},
			initDeviceList() {
				response = getDeviceInfo()
				response.then(res => {
					this.deviceList = res.data.data || ["自动气象站", "雨量筒", "能见度仪", "云高仪", "雨滴谱仪", "雾滴谱仪",
						"颗粒物仪", "微雨雷达", "微波辐射计"
					]
					
					if (window.location.href.lastIndexOf('data-level') != -1) {
						if (window.location.href.split('data-level=')[1] != null) {
							deviceId = this.getDeviceId()
							dName = this.deviceList[deviceId].deviceName || ''
							this.breadcrumbs.push(dName + this.dataTypeDict[window.location.href.split(
								'data-level=')[1][0]])
						} else {
							return;
						}
					}
				}).catch(err => {
					this.deviceList = ["自动气象站", "雨量筒", "能见度仪", "云高仪", "雨滴谱仪", "雾滴谱仪", "颗粒物仪", "微雨雷达",
						"微波辐射计"
					]
				})		

			},
			toPage(item) {
				switch (item) {
					case '现代观测数据':
						pushTo('inner-page-currentDataIntroduce.html')
						break

					case '历史观测数据':
						pushTo('inner-page-historyIntroduce.html')
						break
				}
			},
			getDeviceId(){
				if (window.location.href.lastIndexOf('device-id=')!=-1)
				{
					return window.location.href.split('device-id=')[1][0]
				}
			}
		}
	})
</script>
