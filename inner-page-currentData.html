<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<meta content="width=device-width, initial-scale=1.0" name="viewport">

		<title>1级现代观测数据</title>
		<meta content="" name="description">
		<meta content="" name="keywords">

		<!-- Favicons -->
		<link href="assets/img/favicon.png" rel="icon">
		<link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

		<!-- Google Fonts -->
		<link
			href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
			rel="stylesheet">

		<!-- Vendor CSS Files -->
		<link href="assets/vendor/animate.css/animate.min.css" rel="stylesheet">
		<link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
		<link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
		<link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
		<link href="assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet">
		<link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
		<link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
		<link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
		<link href="assets/bootstrap-year-calendar/css/bootstrap-year-calendar.css">
		<link href="assets/bootstrap-year-calendar/css/bootstrap-year-calendar.min.css">
		<!-- Template Main CSS File -->
		<link href="assets/css/style.css" rel="stylesheet">s

		<!-- 导入阿里的图标样式文件 -->
		<link rel="stylesheet" href="assets/css/iconfont.css">
		<link rel="stylesheet" href="assets/css/left_nav.css">

		<!-- js -->
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/bootstrap-year-calendar/js/bootstrap-year-calendar.js"></script>
		<script src="assets/bootstrap-year-calendar/js/bootstrap-year-calendar.min.js"></script>
		<!-- import moment JavaScript -->
		<script src="assets/js/moment.js"></script>
		<script src="assets/js/moment.min.js"></script>
		<!-- import element-ui CSS -->
		<link rel="stylesheet" href="assets/css/element-ui/theme-chalk/index.css">
		<!-- import Vue before Element -->
		<script src="assets/js/vue/vue.js"></script>
		<!-- import element-ui JavaScript -->
		<script src="assets/js/element-ui/lib/index.js"></script>
	</head>

	<body>
		<!-- ======= Header ======= -->
		<div id="head"></div>
		<script>
			$("#head").load("head.html");
		</script>
		<!-- End Header -->
		<main id="main" style="margin-top: 0;">

			<!-- ======= Breadcrumbs Section ======= -->
			<section id="breadcrumbs" class="breadcrumbs">
			</section>
			<script>
				$('#breadcrumbs').load('components/breadcrumbs.html')
			</script>
			<!-- End Breadcrumbs Section -->
			<section class="inner-page">
				<div class="container calendar-content-center">
					<div class="col-lg-9 mt-4 mt-lg-0">
						<div class="tab-content">
							<p id="deviceName" style="margin-top: 10px;">便携式自动气象站
							<p>
							<div id="calender">
								<el-container>
									<el-header style="height: 100%;">
										<div class="choose-box">
											<div style="padding: 5px;"><span style="margin-top: 5px;"
													class="demonstration">起始日</span>
												<el-date-picker style="margin-top: 5px;" v-model="fromDate" type='date'
													placeholder="选择日">
												</el-date-picker>
											</div>

											<div style="padding: 5px;"><span style="margin-top: 5px;"
													class="demonstration">结束日</span>
												<el-date-picker style="margin-top: 5px;" v-model="endDate" type='date'
													placeholder="选择日">
												</el-date-picker>
											</div>
											<div style="margin-left: 1.25rem;">
												<!-- <el-checkbox :indeterminate="isIndeterminate" v-model="checkAll"
													@change="handleCheckAllChange">全选</el-checkbox>
												<div style="margin: 15px 0;"></div> -->
												<el-checkbox-group v-model="checkedType"
													@change="handleCheckedTypeChange">
													<el-checkbox v-for="type in types" :label="type" :key="type">
														{{type}}格式
													</el-checkbox>
												</el-checkbox-group>
											</div>
											<el-button
												style="width: -webkit-fit-content; height: 100%;"
												type="primary" @click="downloadData()" rounds>下载数据
											</el-button>
										</div>
									</el-header>

									<el-main style="text-align: center;">
										<el-row style="display: inline-flex; margin-top: 10px;">
											<el-button class="year-change" @click="pervious" v-if="isShowPerviousButton"
												style="margin-right: 5px;" icon="el-icon-arrow-left" circle>
											</el-button>
											<el-radio-group v-model="showYear">
												<el-radio-button style="margin: 0;" v-for="(item,index) in yearList"
													:label="item"></el-radio-button>
											</el-radio-group>
											<el-button class="year-change" @click="next" v-if="isShowNextButton"
												style="margin-left: 5px;" icon="el-icon-arrow-right" circle></el-button>
										</el-row>
										<div id="data-tips">
											<el-tag class="tips-hasData">有数据</el-tag>
											<el-tag class="tips-noData">无数据</el-tag>
										</div>
										<el-row v-if="isRefresh">
											<el-col :span="6" v-for="(item,index) in monthList" :key="item">
												<span style="margin-bottom: 5px;"><strong>{{ monthSet[index] }}月</strong></span>
												<el-calendar :value="showYear +'-' + item">
													<template slot="dateCell" slot-scope="{ data }">
														<div :class="hasData(data)">
															{{ data.day.split('-').slice(2).join('-') }}
														</div>
													</template>
												</el-calendar>
											</el-col>
										</el-row>
									</el-main>
								</el-container>
							</div>
						</div>
					</div>
				</div>
				</div>
				</div>
			</section>

		</main>
		<!-- End #main -->

		<!-- ======= Footer ======= -->
		<footer id="footer">
			<div class="container d-md-flex py-4">

				<div class="me-md-auto text-center text-md-start">
					<div class="copyright">
						&copy; Copyright <strong><span>中国气象局人工影响天气中心</span></strong>. All Rights Reserved
					</div>

				</div>
			</div>
		</footer>
		<!-- End Footer -->
		<a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
				class="bi bi-arrow-up-short"></i></a>

		<!-- Vendor JS Files -->
		<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
		<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
		<script src="assets/vendor/php-email-form/validate.js"></script>
		<script src="assets/vendor/purecounter/purecounter.js"></script>
		<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>

		<!-- Template Main JS File -->
		<script src="assets/js/main.js"></script>
	</body>
	<style>
		.choose-box {
			text-align: center;
			margin: 0.3125rem;
			display: flex;
			flex-direction: row;
			flex-wrap: nowrap;
			align-content: center;
			justify-content: center;
			align-items: center;
		}
		.el-checkbox-group{
			display: flex;
			flex-direction: column;
			align-items: flex-start;
		}
		.el-checkbox:last-of-type {
		    margin-right: 30px;
		}
		.calendar-content-center {
			display: flex;
			flex-direction: row;
			flex-wrap: nowrap;
			align-content: center;
			justify-content: center;
		}

		#data-tips {
			margin-top: 5px;
			margin-bottom: 15px;
		}

		.year-change,
		.year-change:focus {
			background-color: #FFFFFF;
			border-color: #FFFFFF;
			color: #1977CC;
		}

		.year-change:hover {
			background-color: #F1F7FD;
			border-color: #F1F7FD;
			color: #1977CC;
		}

		.tips-hasData {
			background-color: #1977CC;
			border-color: #1977CC;
			color: #FFFFFF;
		}

		.tips-noData {
			background-color: #FFFFFF;
			border-color: #1977CC;
			color: #000000;
		}

		.el-radio-button__inner:hover {
			color: #1977CC;
		}

		.el-radio-button__orig-radio:checked+.el-radio-button__inner {
			color: #FFF;
			background-color: #1977CC;
			border-color: #1977CC;
			-webkit-box-shadow: -1px 0 0 0 #1977CC;
			box-shadow: -1px 0 0 0 #1977CC;
		}

		.el-button--primary {
			color: #FFF;
			background-color: #1977CC;
			border-color: #1977CC;
		}

		.el-row {
			display: flex;
			box-sizing: border-box;
			flex-direction: row;
			flex-wrap: wrap;
			align-content: center;
			justify-content: center;
		}

		/* .el-calendar {
			margin-bottom: 15px;
		} */

		.el-calendar__body {
			width: 230px;
			height: 200px;
			padding-top: 0px;
			padding-bottom: 45px;
		}

		.el-calendar__header {
			display: none;
		}

		.el-calendar-table .el-calendar-day {
			width: 100%;
			height: 30px;
			padding: 0;
		}

		.el-col {
			border-radius: 4px;
			/* margin-top: 35px; */
		}

		.el-col-6 {
			width: 230px;
		}

		.el-calendar-table td.is-selected {
			background-color: #FFFFFF;
		}

		.is-selected {
			background-color: #ffffff;
		}

		.el-calendar-table thead {
			display: none;
		}

		.has-data {
			background-color: #1977CC;
			color: #FFFFFF;
			width: 26px;
			height: 30px;
		}

		.el-backtop,
		.el-calendar-table td.is-today {
			color: #000000;
		}
	</style>
	<script src="assets/js/login/login.js"></script>
	<script>
		const chooseDownloadTypeOptions = ['csv', 'nc']
		new Vue({
			el: '#calender',
			data() {
				return {
					dataPickerOption: 'year',
					value: new Date(),
					showYear: 2022,
					dayTime: ['2022-01-22', '2022-01-23', '2022-01-24', '2022-01-25', '2022-01-26', '2022-01-27',
						'2022-01-18', '2022-03-28'
					],
					fromDate: '',
					endDate: '',
					monthList: ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'],
					isRefresh: true,
					defaultYear: 2022,
					yearList: [2018, 2019, 2020, 2021, 2022],
					isShowPerviousButton: true,
					isShowNextButton: true,
					checkAll: false,
					checkedType: ['csv'],
					types: chooseDownloadTypeOptions,
					isIndeterminate: true
				}
			},
			beforeMount() {
				this.createYearList(this.defaultYear)
			},
			watch: {
				dataPickerOption() {
					this.fromDate = ''
					this.endDate = ''
				},
				showYear() {
					if (this.defaultYear > 2015 && this.defaultYear < 2044) {
						this.isShowNextButton = true
						this.isShowPerviousButton = true
					}
					if (this.defaultYear <= 2015) {
						this.isShowPerviousButton = false
					}
					if (this.defaultYear >= 2044) {
						this.isShowNextButton = false
					}
				}

			},
			computed: {
				datePickStatus: function() {
					if (this.fromDate != '' && this.endDate != '' && this.endDate != null && this.fromDate !=
						null) {
						return true
					} else {
						return false
					}
				},
			},
			methods: {
				/**
				 * 得到开始和结束日期，得到中间所有天返回数组
				 * @param {String} string 开始日期'2021-7-1'
				 * @param {String} String 结束日期'2021-8-1'
				 * @return {Array} ['2021-07-01', '2021-07-01'...., '2021-08-01']
				 */
				getDayArr(startDay, endDay) {
					let startVal = moment(new Date(startDay)).format('YYYY-MM-DD')
					let dayArr = []
					while (moment(startVal).isBefore(endDay)) {
						dayArr.push(startVal)
						// 自增
						startVal = moment(new Date(startVal)).add(1, 'day').format('YYYY-MM-DD')
					}
					// 将结束日期的天放进数组
					dayArr.push(moment(new Date(endDay)).format('YYYY-MM-DD'))
					return dayArr
				},

				downloadData() {
					if (this.datePickStatus) {
						console.log(this.getDayArr(this.fromDate, this.endDate))
						this.$message.success('请求成功，等待服务器响应！');
					} else {
						this.$message.error('请先选择下载日期！');
					}
				},
				createYearList(indexYear) {
					this.yearList = Array(7).fill(0).map((v, i) => i + indexYear)
				},

				pervious() {
					this.defaultYear -= 1
					this.showYear -= 1
					this.createYearList(this.defaultYear)
				},
				next() {
					this.defaultYear += 1
					this.showYear += 1
					this.createYearList(this.defaultYear)
				},
				hasData(data) {
					for (var i = 0; i < this.dayTime.length; i++) {
						if (this.dayTime[i] == data.day) {
							return 'has-data'
						}
					}
				},
				handleCheckAllChange(val) {
					this.checkedType = val ? chooseDownloadTypeOptions : [];
					this.isIndeterminate = false;
				},
				handleCheckedTypeChange(value) {
					let checkedCount = value.length;
					this.checkAll = checkedCount === this.types.length;
					this.isIndeterminate = checkedCount > 0 && checkedCount < this.types.length;
				}
			}
		})
	</script>
</html>
